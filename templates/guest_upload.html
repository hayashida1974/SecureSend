<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>Secure Send</title>

  <!-- Bootstrap CDN -->
  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
    rel="stylesheet">
  <!-- Dropzone -->
  <link
    href="https://unpkg.com/dropzone@5/dist/min/dropzone.min.css"
    rel="stylesheet">
  <script src="https://unpkg.com/dropzone@5/dist/min/dropzone.min.js"></script>

  <script src="{{ url_for('static', filename='js/dropzone.js') }}"></script>

  <style>
    body {
      background-color: #f4f6f8;
    }
    /* Dropzone */
    .dz-wrapper {
      position: relative;
    }
    #dz {
      position: relative;
      min-height: 120px;

      border: 2px dashed #0d6efd;      /* ç‚¹ç·šæ  */
      border-radius: .75rem;

      background-color: #f0f6ff;       /* ã†ã™ã„é’ */

      display: flex;
      flex-wrap: wrap;      /* æŠ˜ã‚Šè¿”ã— */
      align-items: flex-start;
      gap: 12px;            /* â† ãƒ•ã‚¡ã‚¤ãƒ«åŒå£«ã®éš™é–“ */
      padding: 12px;  
    }
    #dz-upload {  /* ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ãƒœã‚¿ãƒ³ï¼šå¸¸ã«å³ä¸Š */
      position: absolute;
      top: 12px;
      right: 12px;
      z-index: 10;
    }
    #dz-placeholder { /* ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼ï¼šä¸­å¤®å¯„ã› */
      position: absolute;
      inset: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      pointer-events: none; /* ãƒ‰ãƒ­ãƒƒãƒ—æ“ä½œã‚’é‚ªé­”ã—ãªã„ */
    }
  </style>
</head>
<body>

<div class="container py-4 w-50">

  <!-- Header -->
  <div class="d-flex justify-content-between align-items-center mb-4">
    <div>
      <img
        src="{{ url_for('static', filename='img/app_logo.png') }}"
        alt="Secure Send"
        height="100">
    </div>
  </div>

  <div class="container d-flex align-items-center justify-content-center">
    <div class="card shadow-sm" style="width: 100%;">
      <div class="card-body p-4">

        <!-- Header -->
        <div class="mb-4">
          <h1 class="h5 fw-bold mb-2">
            {{ upload_request.title or "ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰" }}
          </h1>
          <p class="text-muted small mb-0">
            æœ‰åŠ¹æœŸé™ï¼š{{ upload_request.expires_at }}
          </p>
        </div>

        <!-- Dropzone -->
        <div class="dz-wrapper">
        <form
          action="{{ url_for('guest.guest_upload_file', token=upload_request.upload_token) }}"
          method="post"
          class="dropzone rounded-4 text-center"
          id="dz">

          <!-- CSRFãƒˆãƒ¼ã‚¯ãƒ³ -->
          <input type="hidden" name="_csrf_token" value="{{ csrf_token() }}">

          <div id="dz-placeholder">
            <div class="mb-2">
              <svg
                width="40"
                height="40"
                fill="none"
                stroke="currentColor"
                stroke-width="1.5"
                class="text-primary"
                viewBox="0 0 24 24">
                <path d="M12 16V4"></path>
                <path d="M8 8l4-4 4 4"></path>
                <path d="M4 16v2a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-2"></path>
              </svg>
            </div>

            <p class="fw-semibold text-primary mb-1">
              ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã“ã“ã«ãƒ‰ãƒ©ãƒƒã‚°ï¼†ãƒ‰ãƒ­ãƒƒãƒ—
            </p>

            <p class="small text-muted mb-0">
              ã¾ãŸã¯ã‚¯ãƒªãƒƒã‚¯ã—ã¦ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠ
            </p>
          </div>
        </form>
        <button
          id="dz-upload"
          class="btn btn-outline-primary float-end">
          ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
        </button>
        </div><!-- Dropzone -->

        ğŸ“„ ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰æ¸ˆã¿ãƒ•ã‚¡ã‚¤ãƒ«
        {% if files %}
          <div class="table-responsive">
            <table class="table align-middle">
              <thead class="table-light">
                <tr>
                  <th>ãƒ•ã‚¡ã‚¤ãƒ«å</th>
                  <th style="width: 120px;">ã‚µã‚¤ã‚º</th>
                </tr>
                </thead>
                <tbody>
                {% for f in files %}
                <tr>
                  <td>
                    <div class="fw-semibold">
                        {{ f.original_name }}
                    </div>
                  </td>
                  <td>
                    <div class="fw-semibold">
                        {{ f.file_size | filesize }}
                    </div>
                  </td>
                </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>

        {% else %}
        {% endif %}

      </div>
    </div>
  </div>
</div>

</body>
</html>
